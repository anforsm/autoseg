/home1/09699/anforsm/.local/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home1/09699/anforsm/.local/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
/home1/09699/anforsm/.local/lib/python3.9/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
Using device cuda:1
Instatiating model
Moving model to cuda:1
Wrapping model in DDP
Moved model to device
/scratch/09699/anforsm/github/autoseg/data/SynapseWeb/kh2015/data/oblique.zarr
Loaded dataset
Starting training
Using device cuda:0
Instatiating model
Moving model to cuda:0
Wrapping model in DDP
Moved model to device
/scratch/09699/anforsm/github/autoseg/data/SynapseWeb/kh2015/data/oblique.zarr
Loaded dataset
Starting training
Using device cuda:2
Instatiating model
Moving model to cuda:2
Wrapping model in DDP
Moved model to device
/scratch/09699/anforsm/github/autoseg/data/SynapseWeb/kh2015/data/oblique.zarr
Loaded dataset
Starting training
Traceback (most recent call last):
  File "/scratch/09699/anforsm/github/autoseg/src/autoseg/train.py", line 249, in <module>
    mp.spawn(main, nprocs=WORLD_SIZE)
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 241, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 197, in start_processes
    while not context.join():
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 158, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 68, in _wrap
    fn(i, *args)
  File "/scratch/09699/anforsm/github/autoseg/src/autoseg/train.py", line 241, in main
    train(model, dataset, batch_size=8)
  File "/scratch/09699/anforsm/github/autoseg/src/autoseg/train.py", line 143, in train
    for batch in batch_iterator:
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/_utils.py", line 721, in reraise
    raise RuntimeError(msg) from None
RuntimeError: Caught PipelineRequestError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 32, in fetch
    data.append(next(self.dataset_iter))
  File "/scratch/09699/anforsm/github/autoseg/src/autoseg/datasets/zarr_dataset.py", line 163, in request_batch
    sample = pipeline.request_batch(request)
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/gunpowder/pipeline.py", line 139, in request_batch
    raise PipelineRequestError(self, request, original_traceback=tb) from None
gunpowder.pipeline.PipelineRequestError: gunpowder.nodes.batch_provider.BatchRequestError: Exception in RandomLocation while processing request
	RAW: ROI: [0:1800, 0:424, 0:424] (1800, 424, 424), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	LABELS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	LABELS_MASK: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	GT_AFFS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	GT_AFFS_MASK: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	AFFS_WEIGHTS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
Batch returned so far:
None

Traceback (most recent call last):
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/gunpowder/nodes/batch_provider.py", line 188, in request_batch
    self.check_request_consistency(request)
  File "/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/site-packages/gunpowder/nodes/batch_provider.py", line 221, in check_request_consistency
    assert (
AssertionError: RandomLocation: Asked for GT_AFFS which this node does not provide

Exception in pipeline:
ZarrSource[/scratch/09699/anforsm/github/autoseg/data/SynapseWeb/kh2015/data/oblique.zarr] -> Pad -> Pad -> Pad -> RandomLocation
while trying to process request

	RAW: ROI: [0:1800, 0:424, 0:424] (1800, 424, 424), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	LABELS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	LABELS_MASK: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	GT_AFFS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	GT_AFFS_MASK: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False
	AFFS_WEIGHTS: ROI: [600:1200, 92:332, 92:332] (600, 240, 240), voxel size: None, interpolatable: None, non-spatial: False, dtype: None, placeholder: False



/scratch/09699/anforsm/miniconda3/envs/autoseg/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 18 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
